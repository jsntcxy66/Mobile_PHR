<!--
  Generated template for the DashboardPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>DASHBOARD</ion-title>
  </ion-navbar>

</ion-header>


<ion-content padding>
  <ion-refresher (ionRefresh)="doRefresh($event)">
    <ion-refresher-content color="primary" pullingIcon="arrow-dropdown" pullingText="Pull to refresh" refreshingSpinner="circles"
      refreshingText="Refreshing..."></ion-refresher-content>
  </ion-refresher>
  <ion-list>
    <ion-list-header>Recent Events</ion-list-header>

    <ion-card *ngIf="appointments.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="far fa-calendar-alt"></i>
            </ion-icon>
            <span>Appointment</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let appointment of appointments" (click)="goToAppointment()">
            <h2>{{appointment.date | date}} at {{appointment.time}}</h2>
            <h3>{{appointment.location}}</h3>
            <p>{{appointment.firstname | titlecase}} {{appointment.lastname | titlecase}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="labtests.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-file-medical-alt"></i>
            </ion-icon>
            <span>Abnormal Lab Test</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let labtest of labtests; let i = index;" (click)="goToLabtest(i)">
            <h2 text-wrap>{{labtest.subtest}} {{labtest.result}}
              <span *ngIf="labtest.unit.length!=0"> {{labtest.unit}}</span>
            </h2>
            <p>{{labtest.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="dp.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-file-medical-alt"></i>
            </ion-icon>
            <span>Diagnostic Procedure</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let dp of dp; let j = index;" (click)="goToDiagnosticProcedure(j)">
            <div>
              <div *ngIf="dp.typeid==2 || dp.typeid==3 || dp.typeid==4 || dp.typeid==5">
                <h2 text-wrap>{{dp.organ}} {{dp.result}}</h2>
              </div>
              <div *ngIf="dp.typeid==1 || dp.typeid==6 || dp.typeid==7 || dp.typeid==8">
                <h2 text-wrap>{{dp.testname}} {{dp.result}}</h2>
              </div>
              <p>{{dp.date | date}}</p>
            </div>
            <p text-wrap item-end>{{dpName[dp.typeid-1]}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="medications.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-capsules"></i>
            </ion-icon>
            <span>Medication</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let medication of medications" (click)="goToMedication()">
            <h2>{{medication.name}}</h2>
            <h3>{{medication.frequency}}</h3>
            <p>{{medication.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="immunizations.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-syringe"></i>
            </ion-icon>
            <span>Immunization</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let immunization of immunizations" (click)="goToImmunization()">
            <h2>{{immunization.vaccine}}</h2>
            <h3>{{immunization.schedule}}</h3>
            <p>{{immunization.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="dvnotes.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-user-md"></i>
            </ion-icon>
            <span>Doctor Visit Notes</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let d of dvnotes" (click)="goToDoctorVisitNotes()">
            <h2>{{d.diagnosis}}</h2>
            <h3>{{d.doctor}}</h3>
            <p>{{d.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="allergy.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-allergies"></i>
            </ion-icon>
            <span>Allergy History</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let al of allergy" (click)="goToAllergy()">
            <h2>{{al.category}}</h2>
            <p>{{al.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="medical.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-file-medical"></i>
            </ion-icon>
            <span>Medical History</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let me of medical" (click)="goToMedical()">
            <h2>{{me.diagnosis}}</h2>
            <p>{{me.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="social.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-file-medical"></i>
            </ion-icon>
            <span>Social History</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let so of social" (click)="goToSocial()">
            <div>
              <div *ngIf="so.socialType=='smoking'">
                <h2>{{so.amount}} cigarettes</h2>
              </div>
              <div *ngIf="so.socialType=='alcohol'">
                <h2>{{so.name}}</h2>
              </div>
              <div *ngIf="so.socialType=='drug'">
                <h2>{{so.amount}} {{so.name}}</h2>
              </div>
              <div *ngIf="so.socialType=='travel'">
                <h2>{{so.location}}</h2>
              </div>
              <p *ngIf="so.date">{{so.date | date}}</p>
            </div>
            <p item-end>{{so.socialType | titlecase}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="surgical.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-file-medical"></i>
            </ion-icon>
            <span>Surgical History</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let su of surgical" (click)="goToSurgical()">
            <h2>{{su.surgery}}</h2>
            <h3>{{su.doctor}}</h3>
            <p>{{su.date | date}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="family.length!=0">
      <ion-card-content>
        <ion-card-title>
          <ion-item no-padding>
            <ion-icon item-start>
              <i class="fas fa-file-medical"></i>
            </ion-icon>
            <span>Family History</span>
          </ion-item>
        </ion-card-title>
        <ion-list>
          <ion-item *ngFor="let fa of family" (click)="goToFamily()">
            <div>
              <h3>{{fa.disease}}</h3>
              <p>{{fa.date | date}}</p>
            </div>
            <p item-end>{{fa.relationship}}</p>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

  </ion-list>
</ion-content>
